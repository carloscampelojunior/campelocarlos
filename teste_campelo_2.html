<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Comparador Dropbox – estilo Juxtapose</title>

<!-- ========== ESTILO BÁSICO ========== -->
<style>
  :root{--panel:#0b1220;--line:#1f2937;--text:#e5e7eb;--accent:#38bdf8;}
  *{box-sizing:border-box}
  body{margin:0;background:#0a1020;color:var(--text);font:500 15px/1.42 system-ui,Segoe UI,Roboto}
  header{padding:16px 20px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
  .btn{background:#0e1a30;border:1px solid #22314a;color:#e2e8f0;padding:8px 12px;border-radius:10px;cursor:pointer}
  .btn:hover{border-color:#2e476f}
  .stage{position:relative;max-width:1100px;margin:24px auto;border:1px solid var(--line);border-radius:16px;overflow:hidden;background:#0a1220;aspect-ratio:16/9;touch-action:none}
  .layer{position:absolute;inset:0}
  .layer img{width:100%;height:100%;object-fit:contain;background:#0b1120}
  .mask{position:absolute;inset:0;overflow:hidden;pointer-events:none}
  .mask img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain}
  .handle{position:absolute;top:0;bottom:0;width:2px;background:var(--accent);cursor:ew-resize}
  .knob{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:44px;height:44px;border-radius:999px;border:2px solid var(--accent);display:grid;place-items:center;background:#06111f}
  .knob:after{content:"◄ ►";font-size:14px;color:var(--accent)}
  .legend{position:absolute;bottom:12px;left:12px;right:12px;display:flex;justify-content:space-between;font-size:13px;background:#0e1a30bb;padding:4px 8px;border-radius:10px}
</style>

<!-- ========== DROPBOX CHOOSER SDK ========== -->
<script
  src="https://www.dropbox.com/static/api/2/dropins.js"
  id="dropboxjs"
  data-app-key=sl.u.AGHI3YgWCq28Vobry6a5YN0gKodrRP3LDDkgnoipdRBvYW-XuYKK-y0iq0moh79sThPNiSXIGBZXg_dNrWSQDragOTTnf1CXIFILk492LAB0EGczHJaQfZY_-5a6V2MxJc5IKXQphzJDG_5WNEUm64Hu53zn6Uk_3Lk4wJd-Wgw8njfDPqnaCMJlMtXoxyc8zh9bQLYG9QzzKpctHGxhn78KZI2rvxFl_uaL7LqdF6_2AAujERb7Uo1UrquBrvOXDH3AS9-pBjrn5En-t268hI-IgF21x1cTG3mbu3z7GIlIym7jaOV1aQo5Qsq0_fgrL6mz4fdbij_HThddrVRNq3efFFjIFMmzyAvAriOPxTbkBXU6sMf1KSsgvT85FjTWy13ycPn1DjrlD_AVBsTWXCfFt7_-DlSCNXaxwhMb-Ll0UTGNAWUM5QwsHCjpvQn3D79gYLvGACM-yXwCRmvhgeIoa2KIDTxWdnvvT9NjfA_85HUu0JEuvfcxiUjWwgqmCh8hQe7y9VqZS2PN_-3aPYZ3UI4uIeUU6WMiTLq_vSTnYkUlQmN1zWFTqeMChwcDRuMJ5ohV_x1qo4zx4ymjKwaJW70__TnSmtpiE8cTN-9HkaVehcNW98CUx6f5vcZrMnKF3H5HCABL1UhbelHusSO8iLj2FrPhjlARdwfCGSkL6t9KUoMvqn5M5sjNsFGcRvwRUmpmhEghQ4MUifJJ7O6w5cQFIDdEUmOSS-LUQxmPbjwZ9HJlrtFZucz5_iEnyXpBSBJxZgoIX8ZsyB7p2RxLRBelUiRvrRSbJYRtyNlQ3PGaYVfEKps2rlBtDjuQgA9CWEKKo9nOe0fwWNIvHoHnkd9Z08wA5x0r3DQo3ohxtCeFY6qylpeWA16oRWGkHnRlxyCcn_agDBrZgHDM6QnW8WIOwv-yG1qPHGiYkFp0Szl8GhUkvDRTlbIOmd5Ivs0nWTUyP1t1cIAIybCFY_qWg-mAj5QKdB735CIW8DxkoRwTW1K21V5c9HpA_32j0SlgYmPgvaFBA5_jP6VVaMAOIkcDBQrFo1MOuWGFiXlZ5nG-RurHGjHAJEEW2yrpX-bnK0inHyKjIJhh8EYZL3mNefx6YkwzW83jMFGiiYXbPDNavT45KG2JZWBZU8JcWz72qhBBOzBGyUPQgOoch1kyBK1ida2iODwcU_UVFn7QsntgVYKxQ1U39qpgsd6HPCNak0dKrOxt2KZ0tsgXj5LYJCtdvsW9Jr7LE3tE_XCnojhh-nMcIwRkkImI22DUraf2NWgVx059wHphQBst_g54>
</script>
</head>

<body>
<header>
  <h2>Comparador de Fotos (Dropbox)</h2>
  <button class="btn" onclick="chooseFromDropbox()">Adicionar do Dropbox</button>
</header>

<div class="stage" id="stage" tabindex="0">
  <div class="layer"><img id="imgRight"></div>
  <div class="mask" id="mask"><img id="imgLeft"></div>
  <div class="handle" id="handle" style="left:50%"><div class="knob"></div></div>
  <div class="legend"><span id="leftLabel">Esquerda</span><span id="rightLabel">Direita</span></div>
</div>

<script>
const state={images:[],left:null,right:null,pos:0.5};
const $=s=>document.querySelector(s);
function setPos(p){
  state.pos=Math.max(0.02,Math.min(0.98,p));
  const st=$('#stage'),w=st.clientWidth,x=w*state.pos;
  $('#mask').style.clipPath=`inset(0 ${w-x}px 0 0)`;
  $('#handle').style.left=x+'px';
}
function update(){
  if(state.left) $('#imgLeft').src=state.left;
  if(state.right) $('#imgRight').src=state.right;
}
window.chooseFromDropbox=function(){
  if(!window.Dropbox){alert("Dropbox Chooser não carregou");return;}
  Dropbox.choose({
    extensions:['.png','.jpg','.jpeg','.webp'],
    multiselect:true,
    linkType:'direct',
    success:files=>{
      const urls=files.map(f=>{
        let u=f.link.replace('?dl=0','?raw=1');
        return u;
      });
      if(urls.length>=2){state.left=urls[0];state.right=urls[1];}
      else if(urls.length===1){state.left=urls[0];}
      update();setPos(0.5);
    }
  });
};
// arraste a barra
let drag=false;
$('#handle').addEventListener('mousedown',e=>{drag=true;});
window.addEventListener('mouseup',()=>drag=false);
window.addEventListener('mousemove',e=>{if(!drag)return;const r=$('#stage').getBoundingClientRect();setPos((e.clientX-r.left)/r.width);});
$('#stage').addEventListener('dblclick',()=>setPos(0.5));
new ResizeObserver(()=>setPos(state.pos)).observe($('#stage'));
setPos(0.5);
</script>
</body>
</html>
